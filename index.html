
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Reflections of Love â€“ 25th Anniversary</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
:root {
  --bg-start:#fff5f8; --bg-end:#ffe8ef;
  --accent:#b84a62; --text:#6b3245;
}
*{box-sizing:border-box}
body{
  margin:0;font-family:'Poppins',sans-serif;
  background:linear-gradient(180deg,var(--bg-start),var(--bg-end));
  color:var(--text);overflow-x:hidden;
}
.top{text-align:center;padding:14px 10px}
h1{font-family:'Great Vibes',cursive;font-size:30px;margin:8px 0;color:var(--accent)}
.subtitle{font-size:14px;color:#a86a7a;margin-bottom:10px}
.container{max-width:680px;margin:0 auto;padding:12px}
.card{background:rgba(255,255,255,0.9);border-radius:14px;padding:14px;box-shadow:0 10px 30px rgba(184,74,98,0.08)}
input,textarea,button{font-family:inherit}
input,textarea{width:100%;padding:12px;border-radius:10px;border:1px solid rgba(184,74,98,0.15);margin-top:10px;background:rgba(255,255,255,0.8)}
textarea{min-height:88px;resize:none}
.btn{width:100%;padding:12px;border-radius:12px;border:0;cursor:pointer;font-weight:700;background:linear-gradient(90deg,#ff9fb3,#ff7fa6);color:#fff;margin-top:10px}
.rose-icon{position:fixed;right:14px;top:14px;z-index:60;width:46px;height:46px;border-radius:12px;background:rgba(255,255,255,0.85);display:flex;align-items:center;justify-content:center;font-size:20px;color:var(--accent);box-shadow:0 6px 20px rgba(184,74,98,0.08);cursor:pointer}

.reflections{margin-top:16px;display:flex;flex-wrap:wrap;gap:12px;justify-content:center}
.reflection{position:relative;width:150px;height:140px;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.6s ease}
.reflection svg{position:absolute;left:0;top:0;width:100%;height:100%}
.reflection .txt{position:relative;padding:10px 12px;text-align:center;z-index:2}
.reflection .txt strong{display:block;color:var(--accent);font-size:13px;margin-bottom:4px}
.reflection .txt p{margin:0;font-size:13px;color:#5a2938}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}

.floating-heart{
  position:fixed;bottom:-40px;left:0;width:28px;height:28px;
  background:radial-gradient(circle at 30% 30%,#fff2f6,#ff9fb3);
  pointer-events:none;opacity:0.9;
  transform:translateY(0) scale(1) rotate(0deg);
  transition:transform 6s linear,opacity 6s linear;
  clip-path:path("M24.5 7.5c0-4.142-3.358-7.5-7.5-7.5-2.292 0-4.35 1.032-5.727 2.673C9.85 1.032 7.792 0 5.5 0 1.358 0-2 3.358-2 7.5c0 6.068 11.727 13.5 11.727 13.5S24.5 13.568 24.5 7.5z");
}

/* Popup */
#popup{
  position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0.9);
  background:rgba(255,255,255,0.95);padding:24px 32px;border-radius:20px;
  text-align:center;color:var(--accent);font-family:'Great Vibes',cursive;
  font-size:22px;opacity:0;pointer-events:none;transition:all .4s ease;
  box-shadow:0 8px 28px rgba(184,74,98,0.15);z-index:100;
}
#popup.show{opacity:1;pointer-events:auto;transform:translate(-50%,-50%) scale(1)}
#popup::after{
  content:"ðŸ’–";display:block;font-size:28px;margin-top:6px;animation:beat 1s infinite;
}
@keyframes beat{0%,100%{transform:scale(1)}50%{transform:scale(1.2)}}

/* Host panel */
#hostPanel{
  position:fixed;bottom:0;left:0;right:0;background:#fff5f8;
  border-top:2px solid #ffd3df;max-height:60vh;overflow-y:auto;
  box-shadow:0 -4px 16px rgba(0,0,0,0.1);padding:10px;display:none;z-index:99;
}
#hostPanel.show{display:block}
#hostPanel h3{text-align:center;margin:6px 0 10px;color:var(--accent);}
.host-actions{display:flex;justify-content:center;gap:8px;margin-bottom:8px;}
.host-actions button{
  background:linear-gradient(90deg,#ff9fb3,#ff7fa6);color:#fff;
  border:0;padding:8px 14px;border-radius:8px;font-weight:600;cursor:pointer;
}
.host-list label{display:flex;align-items:center;gap:6px;padding:4px 6px;font-size:13px;border-bottom:1px solid #f7c9d8}
.host-list input{accent-color:#ff7fa6}
</style>
</head>

<body>
<div class="rose-icon" id="hostBtn">ðŸŒ¹</div>
<div class="top">
  <h1>Reflections of Love</h1>
  <div class="subtitle"><b>Share one word â€”<br> whatâ€™s the best thing about this couple?</b></div>
</div>

<div class="container">
  <div class="card">
    <input id="name" placeholder="Your name (optional)" />
    <textarea id="message" placeholder="Write your reflection... (short & sweet)"></textarea>
    <button class="btn" id="shareBtn">ðŸ’Œ Share Reflection</button>
  </div>
  <div class="reflections" id="reflections"></div>
</div>

<div id="popup">Thank you for sharing your love</div>

<!-- Host panel -->
<div id="hostPanel">
  <h3>ðŸŒ¹ Host Controls</h3>
  <div class="host-actions">
    <button id="selectAllBtn">Select All</button>
    <button id="deleteSelBtn">Delete Selected</button>
  </div>
  <div class="host-list" id="hostList"></div>
</div>

<script>const firebaseConfig = {
  apiKey: import.meta.env.VITE_FIREBASE_API_KEY,
  authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,
  databaseURL: import.meta.env.VITE_FIREBASE_DATABASE_URL,
  projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,
  storageBucket: import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,
  appId: import.meta.env.VITE_FIREBASE_APP_ID,
  measurementId: import.meta.env.VITE_FIREBASE_MEASUREMENT_ID
};

if(!firebase.apps.length)firebase.initializeApp(firebaseConfig);
const db=firebase.database();
const ref=db.ref("reflections");

const shareBtn=document.getElementById("shareBtn");
const nameEl=document.getElementById("name");
const msgEl=document.getElementById("message");
const feed=document.getElementById("reflections");
const popup=document.getElementById("popup");
const hostBtn=document.getElementById("hostBtn");
const hostPanel=document.getElementById("hostPanel");
const hostList=document.getElementById("hostList");
const selectAllBtn=document.getElementById("selectAllBtn");
const deleteSelBtn=document.getElementById("deleteSelBtn");
const PIN="1616";

// share reflection
shareBtn.onclick=()=>{
  const text=msgEl.value.trim();
  const name=nameEl.value.trim()||"A Friend";
  if(!text)return msgEl.animate([{transform:"translateX(-6px)"},{transform:"translateX(6px)"},{transform:"translateX(0)"}],{duration:300});
  ref.push({name,text,ts:Date.now()});
  msgEl.value="";showPopup();
};

function render(item,id){
  const el=document.createElement("div");
  el.className="reflection";
  el.innerHTML=`
    <svg viewBox="0 0 100 90"><path d="M50 82 L15 47 A22 22 0 0 1 50 19 A22 22 0 0 1 85 47 Z" fill="#ffdce5" stroke="#ffc0d0" stroke-width="1.2"/></svg>
    <div class="txt"><strong>${escapeHtml(item.name)}</strong><p>${escapeHtml(item.text)}</p></div>`;
  feed.insertBefore(el,feed.firstChild);
  const li=document.createElement("label");
  li.innerHTML=`<input type="checkbox" value="${id}"/>${escapeHtml(item.name)} â€“ ${escapeHtml(item.text)}`;
  hostList.prepend(li);
}
function escapeHtml(s){return s.replace(/[&<>"]/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[c]));}

ref.on("child_added",snap=>{const v=snap.val();if(v)render(v,snap.key);});

function showPopup(){
  popup.classList.add("show");
  setTimeout(()=>popup.classList.remove("show"),1600);
}

// host controls
hostBtn.onclick=()=>{
  const pin=prompt("Enter Host PIN:");
  if(pin===PIN)hostPanel.classList.toggle("show");
  else if(pin)alert("Incorrect PIN");
};
selectAllBtn.onclick=()=>{
  hostList.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=true);
};
deleteSelBtn.onclick=()=>{
  const ids=[...hostList.querySelectorAll('input:checked')].map(i=>i.value);
  if(!ids.length)return alert("No reflections selected");
  if(confirm("Delete selected reflections?")){
    ids.forEach(id=>ref.child(id).remove());
    ids.forEach(id=>{
      const chk=hostList.querySelector(`input[value="${id}"]`);
      if(chk)chk.parentElement.remove();
    });
    // also remove from main feed
    [...feed.children].forEach(div=>{
      if(div.innerText && ids.some(x=>div.innerText.includes(x)))div.remove();
    });
  }
};

// Floating pastel hearts
function spawnHeart(){
  const el=document.createElement("div");
  el.className="floating-heart";
  const size=14+Math.random()*22;
  el.style.left=Math.random()*100+"vw";
  el.style.width=size+"px";el.style.height=size+"px";
  el.style.opacity=0.6+Math.random()*0.4;
  document.body.appendChild(el);
  requestAnimationFrame(()=>{
    el.style.transform=`translateY(-120vh) scale(${1+Math.random()*0.3}) rotate(${Math.random()*360}deg)`;
    el.style.opacity="0";
  });
  setTimeout(()=>el.remove(),6000);
}
setInterval(spawnHeart,700);
</script>
</body>
</html>
